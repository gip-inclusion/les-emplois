{% load django_bootstrap5 %}

{% if filters_form.departments and filters_form.fields.departments.choices %}
    {% if btn_dropdown_filter|default:False %}
        <div class="dropdown">
            <button type="button" class="btn btn-dropdown-filter dropdown-toggle" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
                {{ filters_form.departments.label | capfirst }}
            </button>
            <ul class="dropdown-menu">
                {% for choice in filters_form.departments %}
                    <li class="dropdown-item">
                        <div class="form-check">
                            <input id="{{ choice.id_for_label }}-top" class="form-check-input" name="{{ choice.data.name }}" type="checkbox" value="{{ choice.data.value }}"{% if choice.data.selected %} checked{% endif %}>
                            <label for="{{ choice.id_for_label }}-top" class="form-check-label">{{ choice.choice_label }}</label>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% else %}
        <hr>
        <fieldset>
            <legend>
                <button class="btn btn-outline-transparent has-collapse-caret collapsed"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseDepartments"
                        type="button"
                        aria-expanded="false"
                        aria-controls="collapseDepartments">{{ filters_form.departments.label | capfirst }}</button>
            </legend>
            <div class="my-3 collapse" id="collapseDepartments">
                <ul>
                    {% for choice in filters_form.departments %}
                        <li>
                            <div class="form-check">
                                <input id="{{ choice.id_for_label }}" class="form-check-input" name="{{ choice.data.name }}" type="checkbox" value="{{ choice.data.value }}"{% if choice.data.selected %} checked{% endif %}>
                                <label for="{{ choice.id_for_label }}" class="form-check-label">{{ choice.choice_label }}</label>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </fieldset>
    {% endif %}
{% endif %}
