{% extends "layout/base.html" %}
{% load django_bootstrap5 %}
{% load static %}

{% block title %}
    {% if update_job_seeker %}
        Modification
    {% else %}
        Création
    {% endif %}
    du compte candidat {{ block.super }}
{% endblock %}

{% block content_title %}
    <h1>
        {% if update_job_seeker %}
            Modification
        {% else %}
            Création
        {% endif %}
        du compte candidat
    </h1>
{% endblock %}

{% block content %}
    <section class="s-section-twocolumns s-section">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-4 order-md-2 ps-lg-5 d-none d-lg-block mb-6"></div>
                <div class="col-12 col-lg-8 order-md-1 pe-lg-5">
                    <div class="c-stepper mb-4">
                        <div class="progress progress--emploi mb-2">
                            <div class="progress-bar progress-bar-{{ progress }}" role="progressbar" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100">
                            </div>
                        </div>
                        <span>
                            {% block progress_title %}{% endblock %}
                        </span>
                    </div>
                    <div class="c-form">
                        <h2>
                            {% block step_title %}{% endblock %}
                        </h2>
                        {% if readonly_form %}
                            <div class="alert alert-warning alert-dismissible fade show mb-4">
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Fermer"></button>
                                <div class="row">
                                    <div class="col-auto pe-0">
                                        <i class="ri-information-line ri-xl text-warning"></i>
                                    </div>
                                    <div class="col">
                                        <p>
                                            <strong>Informations modifiables par le candidat uniquement</strong>
                                        </p>
                                        <p>Le candidat s’étant connecté à son compte utilisateur, vous ne pouvez modifier que sa situation administrative.</p>
                                        <a class="btn btn-link" href="{{ step_3_url }}">Voir la situation administrative</a>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        <hr class="mt-5">
                        {% bootstrap_form_errors form type="all" %}
                        <form method="post" class="js-collapsable-subfields js-format-nir">
                            {% csrf_token %}

                            {% block form_content %}{% endblock %}

                            <hr>
                            <div class="form-row align-items-center gx-3">
                                {% if back_url %}
                                    <div class="form-group col-12 col-lg order-2 order-lg-1">
                                        <a href="{{ back_url }}" class="btn btn-link btn-ico ps-lg-0 w-100 w-lg-auto" aria-label="Retourner à l'étape précédente">
                                            <i class="ri-arrow-go-back-line ri-lg"></i>
                                            <span>Retour</span>
                                        </a>
                                    </div>
                                {% endif %}
                                <div class="form-group col-12 col-lg-auto order-1 order-lg-2">
                                    {% bootstrap_button "Suivant" button_type="submit" button_class="btn btn-primary btn-block" %}
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block script %}
    {{ block.super }}
    <script src="{% static 'js/split_nir.js' %}"></script>

    <script nonce="{{ CSP_NONCE }}">
        $(document).ready(() => {
            /**
             * JS to collapse subfields
             **/
            $(".js-collapsable-subfields").each(function() {
                $(this).find('input[type="checkbox"]').change(function(e) {
                    $('#subfields_' + e.target.name).collapse("toggle")
                })
            })
        })
    </script>
{% endblock %}
