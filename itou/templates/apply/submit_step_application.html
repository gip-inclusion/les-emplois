{% extends "apply/submit_base.html" %}
{% load bootstrap4 %}
{% load i18n %}
{% load static %}

{% block extra_head %}
    <!-- Dropzone -->
    <link rel="stylesheet" type="text/css" href='{% static "vendor/dropzone/dropzone.min.css" %}'>
{% endblock extra_head %}

{% block content %}

    {{ block.super }}

    <form method="post" action="" class="js-prevent-multiple-submit">

        {% csrf_token %}

        {% if siae.jobs.exists %}
            {% bootstrap_field form.selected_jobs %}
        {% endif %}

        {% bootstrap_field form.message %}

        <label for="resume_form">{{ form.resume_link.label }}</label>
        <div id="resume_form" class="dropzone border-dashed text-center text-secondary mb-4">
            <div class="dz-message my-1">
                <div class="h5">{% include "includes/icon.html" with icon="upload" size="30" %}</div>
                <div class="h6"><a href="#;">Choisissez un fichier</a> ou <b>glissez ici</b>.</div>
                <div class="small">Taille maximale : {{ s3_max_file_size }} Mo</div>
                <div class="small">Type de fichier : PDF</div>
            </div>
        </div>

        {{ form.resume_link.as_hidden }}

        {% buttons %}
            <button type="submit" class="btn btn-primary">
                {% if request.user.is_siae_staff %}
                    Enregistrer la candidature
                {% else %}
                    Envoyer la candidature
                {% endif %}
            </button>
        {% endbuttons %}

    </form>

{% endblock %}

{% block script %}
    {{ block.super }}
    <!-- Needed to use the Datepicker JS widget. -->
    {{ form.media }}

    {% include "storage/s3_upload.html" with callback_location_selector="input#id_resume_link" dropzone_selector="#resume_form" s3_form_values=s3_form_values s3_upload_config=s3_upload_config %}
{% endblock %}
