{% comment %} takes 2 arguments siae <Siae> and jobs_descriptions <List of SiaeJobDescription> {% endcomment %}
<div class="card my-4">
    <div class="bg-emploi-lightest p-3 p-md-4">
        <p class="d-flex flex-wrap fs-sm mb-2">
            <span class="flex-grow-1 text-primary">
                {% if siae.is_opcs %}
                    <span>Offres clauses sociales</span>
                {% else %}
                    <b>{{ siae.kind }}</b> - {{ siae.get_kind_display }}
                {% endif %}
            </span>
            {% if siae.kind in ea_eatt_kinds %}
                <span class="badge badge-sm badge-pill badge-accent-03 text-primary">Priorité aux bénéficiaires de la RQTH</span>
            {% endif %}
        </p>
        <h3 class="h2 mb-2">
            <a class="matomo-event" href="{{ siae.get_card_url }}?back_url={{ request.get_full_path|urlencode }}" data-matomo-category="candidature" data-matomo-action="clic" data-matomo-option="clic-structure">{{ siae.display_name }}</a>
            {# Display non-user-edited name too, but only if it's not the same text #}
            {% if siae.brand and siae.brand|lower != siae.name|lower %}
                <small class="text-muted">({{ siae.name|title }})</small>
            {% endif %}
        </h3>
        <h4 class="h5 mb-2 text-muted">{{ siae.address_on_one_line }}</h4>
        <p class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center mb-0">
            <span class="align-self-start">
                <span class="badge badge-sm badge-pill badge-primary">à {{ siae.distance|floatformat:"-1"|default:"12" }} km</span>
                {% comment %}
                The "default" distance of 12 kms above seems a little weird.
                Having a default distance to any point does not make a lot of sense, either we have one between point A and B, or nothing.
                But it seems that this template is used when an SIAE looks at itself, and the "distance" span is displayed as well.
                We should have a chat someday with the designers to remove it, as it is probably confusing to just say 12kms from
                no given point, all the time.
                {% endcomment %}
                <span class="text-muted fs-sm ml-1">de votre lieu de recherche.</span>
            </span>
            {% if jobs_descriptions %}
                <a class="d-none d-md-inline font-weight-bold matomo-event mt-3 mt-md-0"
                   href="{{ siae.get_card_url }}?back_url={{ request.get_full_path|urlencode }}"
                   data-matomo-category="candidature"
                   data-matomo-action="clic"
                   data-matomo-option="clic-metiers">
                    Voir tous les métiers ({{ jobs_descriptions|length }})
                </a>
            {% endif %}
        </p>
    </div>
    <div class="card-body p-3 p-md-4">
        {% if siae.count_active_job_descriptions > 0 and not siae.block_job_applications %}
            {% include "siaes/includes/_list_siae_actives_jobs.html" with jobs_descriptions=jobs_descriptions %}
        {% elif not siae.block_job_applications %}
            <div class="d-flex justify-content-between align-items-center">
                <span>Cette structure vous intéresse ?</span>
                <a class="btn btn-sm btn-primary"
                   href="{% url 'apply:start' siae_pk=siae.pk %}{% if back_url %}?back_url={{ back_url }}{% endif %}"
                   title="Proposer votre candidature auprès de l'employeur solidaire {{ siae.display_name }}">
                    Proposer votre candidature
                </a>
            </div>
        {% else %}
            <p class="mb-0">
                <i>Cet employeur ne traite plus de nouvelles candidatures pour le moment</i>
            </p>
        {% endif %}
    </div>
</div>
