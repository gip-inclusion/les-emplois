{% extends "layout/content_small.html" %}
{% load static %}
{% load bootstrap4 %}

{% block title %}Enregistrer une fiche de poste{{ block.super }}{% endblock %}

{% block breadcrumbs %}
    {% include "siaes/includes/_job_description_breadcrumbs.html" %}
{% endblock %}

{% block content %}
    <div class="c-stepper my-3 my-lg-6">
        <div class="progress progress--emploi">
            <div class="progress-bar" role="progressbar" style="width: 33%" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
        <p><strong>Étape 1</strong>/3 : Informations générales</p>
    </div>

    <div class="d-block rounded-lg shadow-lg p-3 p-lg-5">
        <div class="text-center mb-3">
            <img src="{% static 'img/edit_job_description_header.svg' %}" alt="En-tête édition fiche de poste" style="width: 100px;">
        </div>
        <form method="post" action="?step={{ step }}" class="js-prevent-multiple-submit">
            {% bootstrap_form_errors form type="all" %}
            {% csrf_token %}

            <h1 class="text-center mb-5">Informations générales<br> de ma fiche de poste</h1>
            <hr>

            {# autocomplete fields #}
            {% bootstrap_field form.job_appellation %}
            {% bootstrap_field form.job_appellation_code %}

            {% bootstrap_field form.custom_name %}

            {# autocomplete fields #}
            {% bootstrap_field form.location_label %}
            {% bootstrap_field form.location_code %}

            {% bootstrap_field form.hours_per_week %}
            {% bootstrap_field form.contract_type %}
            {% bootstrap_field form.other_contract_type %}
            {% bootstrap_field form.open_positions %}

            {% buttons %}
                <div align="right" class="pt-3">
                    <a class="btn btn-outline-primary" href="{% url "siaes_views:job_description_list" %}" title="Retour à la liste des métiers">Retour</a>
                    <button type="submit" class="btn btn-primary" aria-label="Passer à l'étape suivante">Suivant</button>
                </div>
            {% endbuttons %}
        </div>
{% endblock %}

{% block script %}
    {{ block.super }}
    <script src="{% static "js/job_autocomplete.js" %}"></script>
    <script>
        $("#id_contract_type").change(function() {
            var disabled = $("#id_contract_type").val() != "OTHER"
            console.log(disabled)
            $("#id_other_contract_type").attr("disabled", disabled)
            if (disabled) {
                $("#id_other_contract_type").val("")
            }
        })
    </script>
{% endblock %}
