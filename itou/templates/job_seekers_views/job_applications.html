{% extends "layout/base.html" %}
{% load matomo %}
{% load static %}
{% load str_filters %}
{% load format_filters %}
{% load url_add_query %}

{% block title %}
    Profil de {{ job_seeker.get_full_name|mask_unless:can_view_personal_information }} {{ block.super }}
{% endblock %}

{% block title_content %}
    <div class="d-flex flex-column flex-md-row gap-3 mb-3 justify-content-md-between">
        <h1 class="mb-0">Candidat : {{ job_seeker.get_full_name|mask_unless:can_view_personal_information }}</h1>
        {% url 'search:employers_results' as search_url %}
        {% if can_view_personal_information %}
            {% url_add_query search_url job_seeker=job_seeker.public_id city=job_seeker.city_slug as url_query %}
        {% else %}
            {% url_add_query search_url job_seeker=job_seeker.public_id as url_query %}
        {% endif %}
        <a href="{{ url_query }}" {% matomo_event "candidature" "clic" "postuler-pour-ce-candidat" %} class="btn btn-lg btn-primary btn-ico">
            <i class="ri-draft-line fw-medium" aria-hidden="true"></i>
            <span>Postuler pour ce candidat</span>
        </a>
    </div>
{% endblock %}

{% block title_extra %}
    <ul class="s-tabs-01__nav nav nav-tabs mb-0" role="tablist" data-it-sliding-tabs="true">
        <li class="nav-item" role="presentation">
            <a class="nav-link"
               href="{% url 'job_seekers_views:details' public_id=job_seeker.public_id %}?back_url={% url 'job_seekers_views:list' %}"
               aria-controls="informations"
               aria-selected="true"
               {% matomo_event "candidat" "clic-onglet" "informations candidat" %}>Informations générales</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link active"
               href="{% url 'job_seekers_views:job_applications' public_id=job_seeker.public_id %}?back_url={% url 'job_seekers_views:list' %}"
               aria-controls="candidatures"
               aria-selected="false"
               {% matomo_event "candidat" "clic-onglet" "candidatures" %}>Candidatures</a>
        </li>
    </ul>
{% endblock %}
{% block title_prevstep %}
    {% include "layout/previous_step.html" with back_url=back_url only %}
{% endblock %}

{% block content %}
    <section class="s-section">
        <div class="s-section__container container">
            <div class="s-section__row row">
                <div class="s-section__col col-12">
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="candidatures" role="tabpanel" aria-labelledby="job-applications-tab">
                            <h2>Candidatures envoyées</h2>
                            <hr>
                            {% matomo_event "candidat" "clic" "detail-candidature" as matomo_event_attrs %}
                            {% for job_application in sent_job_applications %}
                                {% url 'apply:details_for_prescriber' job_application_id=job_application.id as detail_url %}
                                {% include "apply/includes/job_application_box_for_user.html" with job_application=job_application detail_url=detail_url matomo_event_attrs=matomo_event_attrs %}
                            {% empty %}
                                <div class="c-box c-box--results my-3 my-md-4">
                                    <div class="c-box--results__body">
                                        <p class="mb-0">Aucune candidature envoyée.</p>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block script %}
    {{ block.super }}
    <script src="{% static 'js/sliding_tabs.js'%}"></script>
{% endblock %}
