{% load bootstrap4 %}

<h4>Domiciliation du salarié</h4>

<div class="alert alert-warning">
    <small>
        <div class="mt-1">    
            Merci de bien vouloir vérifier si le format d'adresse ci-dessous (HEXA) correspond bien
            à l'adresse de l'employé.
        </div>
        <div class="mt-1">    
            <b>Si l'adresse ne correspond pas</b>, merci de mettre à jour l'adresse à l'aide du formulaire
            et de cliquer sur le bouton <b>"Modifier l'adresse"</b> et de repéter l'opération jusqu'à obtention d'une adresse correcte.
        </div>
    </small>
</div>

<form method="POST" action="{% url "employee_record_views:create_step_2" job_application.id %}" class="js-prevent-multiple-submit">
    <div class="alert alert-secondary">
        <h5><b>Adresse retenue</b></h5>

        {% if profile.hexa_address_filled %}
        <div class="row">
            <div class="col-md-3">Numéro</div>
            <div class="col-md-9"><b>{{ profile.hexa_lane_number }} {{ profile.hexa_std_extension }}{{ profile.hexa_non_std_extension }}</b></div>
        </div>
        <div class="row">
            <div class="col-md-3">Voie</div>
            <div class="col-md-9"><b>{{ profile.hexa_lane_name }}</b></div>
        </div>
        <div class="row">
            <div class="col-md-3">Commune</div>
            <div class="col-md-9">
                <b>{{ profile.hexa_post_code }} {{ profile.hexa_commune.name }}</b>
                <br>
                <span><small>(code INSEE : {{ profile.hexa_commune.code }})</small></span>
            </div>
        </div>
        {% else %}
        <div>
            <p><b>L'adresse HEXA de l'employé n'a pu être determinée.</b></p>
            <p>Ceci peut-être du à:
                <ul>
                    <li>une erreur temporaire de géolocalisation</li>
                    <li>une adresse introuvable (code postal ou voie erroné)
                </ul>
            <p>
            <p>
                Veuillez vérifier et modifier les différents éléments de l'adresse, 
                puis cliquez sur le bouton <b>"Modifier l'adresse"</b> dés que tout semble correct.
            </p>
        </div>
        {% endif %}
    </div>

    {% csrf_token %}

    <div class="border-left border-mute mb-4 ml-3 pl-3">

        {% bootstrap_field form.address_line_1 %}
        {% bootstrap_field form.address_line_2 %}

        <div class="row">
            <div class="col-md-3">
                {% bootstrap_field form.post_code %}
            </div>
            <div class="col-md-9">
                {% bootstrap_field form.city %}
            </div>
        </div>

        <small class="text-mute">
            <a href="{{ maps_url }}" target="_blank">Vous avez du mal à déterminer l'adresse de l'employé ? Cliquez-ici pour vérifier</a>
        </small>

        <div class="mt-4">
            {% buttons %}
            <button type="submit" class="btn btn-primary">Modifier l'adresse</button>
            {% endbuttons %}
        </div>

    </div>

    <h4>Téléphone et adresse e-mail du salarié</h4>

    {% bootstrap_field form.phone %}
    {% bootstrap_field form.email %}

</form>


<a class="btn btn btn-outline-secondary" href="{% url "employee_record_views:create" job_application.id %}">Précédent</a>
<a class="btn btn btn-outline-primary" href="{% url "employee_record_views:create_step_3" job_application.id %}">Continuer</a>
