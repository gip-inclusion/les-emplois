{% load enums %}
{% load theme_inclusion %}

{% enums "nexus" "NexusUserKind" as NexusUserKind %}
{% enums "nexus" "Service" as Service %}

<header role="banner" id="header">
    <section class="s-header-nexus">
        <div class="s-header-nexus__container container">
            <div class="s-header-nexus__row row">
                <div class="s-header-nexus__col s-header-nexus__col--logo-service col-auto d-flex align-items-center">
                    <button type="button"
                            class="btn btn-lg btn-ico-only btn-nexus"
                            data-bs-toggle="offcanvas"
                            data-bs-target="#offcanvasNexus"
                            aria-controls="offcanvasNexus"
                            aria-label="Ouvrir le menu de navigation principale pour mobile">
                        <i class="ri-menu-line" id="open" aria-hidden="true"></i>
                        <span class="visually-hidden">Menu</span>
                    </button>
                    <a href="{% url 'nexus:homepage' %}">
                        <img src="{% static_theme_images 'nexus/nx-header-logo-nexus-mini.svg' %}" alt="Nexus - La plateforme de l'inclusion" height="40" width="40">
                    </a>
                </div>
                <div class="s-header-nexus__col s-header-nexus__col--nav col-auto d-flex align-items-center">
                    <span class="btn btn-lg btn-ico-only btn-nexus" data-bs-toggle="tooltip" data-bs-title="{{ user.email }}">
                        <i class="ri-account-circle-line" aria-hidden="true"></i>
                        <span class="visually-hidden">{{ user_name }}</span>
                    </span>
                    <a href="{% url 'nexus:contact' %}" class="btn btn-lg btn-ico-only btn-nexus">
                        <i class="ri-question-line" aria-hidden="true"></i>
                        <span class="visually-hidden">Besoin d'aide ?</span>
                    </a>
                    <form method="post" action="{{ logout_url }}">
                        {% csrf_token %}
                        <button class="btn btn-lg btn-ico-only btn-nexus">
                            <i class="ri-logout-circle-line" aria-hidden="true"></i>
                            <span class="visually-hidden">Déconnexion</span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <div class="offcanvas" id="offcanvasNexus">
        <div class="offcanvas-body">
            <nav role="navigation" aria-label="Navigation principale pour mobile">
                <div class="d-flex align-items-center mb-1">
                    <strong class="flex-grow-1 mb-0">TABLEAU DE BORD</strong>
                    <div class="d-md-none">
                        <button type="button" class="btn btn-lg btn-ico-only btn-nexus justify-content-center" data-bs-dismiss="offcanvas" aria-label="Fermer le menu de navigation principale pour mobile">
                            <i class="ri-close-line" id="close" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
                <ul>
                    <li>
                        <a href="{% url 'nexus:homepage' %}" class="btn btn-lg btn-ico btn-nexus{% if menu == 'homepage' %} active{% endif %}" aria-label="Retour à l'accueil">
                            <i class="ri-home-line" aria-hidden="true"></i>
                            <span class="d-md-none d-xl-inline-flex ">Accueil</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'nexus:structures' %}" class="btn btn-lg btn-ico btn-nexus{% if menu == 'structures' %} active{% endif %}" aria-label="Retour à l'accueil">
                            <i class="ri-community-line" aria-hidden="true"></i>
                            <span class="d-md-none d-xl-inline-flex ">Infos structure</span>
                        </a>
                    </li>
                </ul>
                {% if user_kind == NexusUserKind.FACILITY_MANAGER %}
                    <strong>GÉRER MES OFFRES</strong>
                    <ul>
                        <li>
                            <a href="{% url 'nexus:emplois' %}" class="btn btn-lg btn-logo btn-nexus{% if menu == Service.EMPLOIS %} active{% endif %}" aria-label="Mes offres d’emploi">
                                <img src="{% static_theme_images 'nexus/nx-header-logo-emplois.svg' %}" height="40" width="40" alt="">
                                <span class="d-md-none d-xl-inline-flex flex-grow-1">Fiches de poste</span>
                                {% if emplois_badge_count is not None %}
                                    <span class="badge rounded-pill badge-sm bg-info-lighter text-info">{{ emplois_badge_count }}</span>
                                {% endif %}
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'nexus:dora' %}" class="btn btn-lg btn-logo btn-nexus{% if menu == Service.DORA %} active{% endif %}" aria-label="Mes services d’insertion">
                                <img src="{% static_theme_images 'nexus/nx-header-logo-dora.svg' %}" height="40" width="40" alt="">
                                <span class="d-md-none d-xl-inline-flex flex-grow-1">Services d’insertion</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'nexus:marche' %}" class="btn btn-lg btn-logo btn-nexus{% if menu == Service.MARCHE %} active{% endif %}" aria-label="Mon activité commerciale">
                                <img src="{% static_theme_images 'nexus/nx-header-logo-marche.svg' %}" height="40" width="40" alt="">
                                <span class="d-md-none d-xl-inline-flex flex-grow-1">Prestations commerciales</span>
                            </a>
                        </li>
                    </ul>
                {% else %}
                    <strong>TROUVER & ORIENTER</strong>
                    <ul>
                        <li>
                            <a href="{% url 'search:employers_home' %}" class="btn btn-lg btn-logo btn-nexus{% if menu == Service.EMPLOIS %} active{% endif %}" aria-label="Offres d’emploi">
                                <img src="{% static_theme_images 'nexus/nx-header-logo-emplois.svg' %}" height="40" width="40" alt="">
                                <span class="d-md-none d-xl-inline-flex flex-grow-1">Offres d’emploi</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'nexus:dora' %}" class="btn btn-lg btn-logo btn-nexus{% if menu == Service.DORA %} active{% endif %}" aria-label="Mes services d’insertion">
                                <img src="{% static_theme_images 'nexus/nx-header-logo-dora.svg' %}" height="40" width="40" alt="">
                                <span class="d-md-none d-xl-inline-flex flex-grow-1">Services d’insertion</span>
                            </a>
                        </li>
                    </ul>
                {% endif %}
                <strong>ACCOMPAGNER & SUIVRE</strong>
                <ul>
                    <li>
                        <a href="{% url 'nexus:mon_recap' %}" class="btn btn-lg btn-logo btn-nexus{% if menu == Service.MON_RECAP %} active{% endif %}" aria-label="Commande de carnets">
                            <img src="{% static_theme_images 'nexus/nx-header-logo-monrecap.svg' %}" height="40" width="40" alt="">
                            <span class="d-md-none d-xl-inline-flex flex-grow-1">Commande de carnets</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'nexus:pilotage' %}" class="btn btn-lg btn-logo btn-nexus{% if menu == Service.PILOTAGE %} active{% endif %}" aria-label="Suivi d’activité">
                            <img src="{% static_theme_images 'nexus/nx-header-logo-pilotage.svg' %}" height="40" width="40" alt="">
                            <span class="d-md-none d-xl-inline-flex flex-grow-1">Suivi d’activité</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="mt-3">
                <hr>
                <ul>
                    <li>
                        <span class="btn btn-lg btn-ico btn-nexus" aria-label="Accéder à votre compte" data-bs-toggle="tooltip" data-bs-title="{{ user.email }}">
                            <i class="ri-account-circle-line" aria-hidden="true"></i>
                            <span class="d-md-none d-xl-inline-flex">{{ user_name }}</span>
                        </span>
                    </li>
                    <li>
                        <a href="{% url 'nexus:contact' %}" class="btn btn-lg btn-ico btn-nexus" aria-label="Besoin d'aide ?">
                            <i class="ri-question-line" aria-hidden="true"></i>
                            <span class="d-md-none d-xl-inline-flex">Besoin d'aide ?</span>
                        </a>
                    </li>
                    <li>
                        <form method="post" action="{{ logout_url }}">
                            {% csrf_token %}
                            <button class="btn btn-lg btn-ico btn-nexus">
                                <i class="ri-logout-circle-line" aria-hidden="true"></i>
                                <span class="d-md-none d-xl-inline-flex">Déconnexion</span>
                            </button>
                        </form>
                    </li>
                    <li>
                        <a href="" class="d-none d-md-inline-block d-xl-none">
                            <img src="{% static_theme_images 'nexus/nx-header-logo-nexus-mini.svg' %}" alt="Nexus - La plateforme de l'inclusion" height="40" width="40">
                        </a>
                        <a href="" class="d-md-none d-xl-inline-block px-1">
                            <img src="{% static_theme_images 'nexus/nx-header-logo-nexus.svg' %}" alt="Nexus - La plateforme de l'inclusion" height="50" width="133">
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</header>
